/*****************************************************************************************************************************************************/
/*****************************************************************************************************************************************************/
/***                                                                                                                                               ***/
/***     >>>>>   This is the script used to create the table [-----].[---].[ft_01__vl_LongData]                                             <<<<<     ***/
/***                                                                                                                                               ***/
/*****************************************************************************************************************************************************/
USE [x_LoadRLS1cUS]
GO
/*****************************************************************************************************************************************************/
/***  backup as needed *******************************************************************************************************************************/
/*
  DECLARE @CrDt    varchar(15)
  SET     @CrDt = (REPLACE((REPLACE((CONVERT(VARCHAR(19),GETDATE(),126)),'-','')),':',''))
/*---------------------------------------------------------------------------------------------------------------------------------------------------*/
EXEC ( '   SELECT * INTO  [vl_LongData_until_' + @CrDt + ']
                    FROM  [vl_LongData]'                    )
                                                                                                                                                     */
/*****************************************************************************************************************************************************/
IF OBJECT_ID           (N'[vl_LongData]', N'U') IS NOT NULL
DROP TABLE                [vl_LongData]
SELECT * INTO             [vl_LongData]
FROM
/*****************************************************************************************************************************************************/
(
/*****************************************************************************************************************************************************/
SELECT
-------------------------------------------------------------------------------------------------------------------------------------------------------
        QA.[Data_source_name]
      , SR.[Svy_Respondent_pk]
      , SR.[weight]
      , QA.[Question_abbreviation_std]
      , QA.[Answer_Wording_std]
      , QA.[Question_Year]              AS [Survey_Year]
/*---------------------------------------------------------------------------------------------------------------------------------------------------*/
  FROM 
              [Pew_Survey_Respondent_Answer]            RA
/*---------------------------------------------------------------------------------------------------------------------------------------------------*/
LEFT
JOIN
/*---------------------------------------------------------------------------------------------------------------------------------------------------*/
              [Pew_Survey_Respondent]                   SR
       ON
           RA.[Svy_Respondent_fk]
         = SR.[Svy_Respondent_Pk]
/*---------------------------------------------------------------------------------------------------------------------------------------------------*/
LEFT
JOIN
/*---------------------------------------------------------------------------------------------------------------------------------------------------*/
              [Pew_Q&A]                                  QA
       ON
           RA.[Answer_fk]
         = QA.[Answer_fk]
/*---------------------------------------------------------------------------------------------------------------------------------------------------*/
/*****************************************************************************************************************************************************/
)                                                                                                                                          vl_LongData
/*****************************************************************************************************************************************************/
GO
/*****************************************************************************************************************************************************/
