/***************************************************************************************************************************************************************/
/***                                                                                                                                                         ***/
/***     >>>>>   This is the master script to run all scripts for re-creating tables and views related to coding procedures                        <<<<<     ***/
/***                                                                                                                                                         ***/
/***        NOTICE:                                                                                                                                          ***/
/***                     This is a SQLCMD script which requires SQLCMD scripting mode to be enabled (from the toolbar icon or the Query menu)                ***/
/***                     Once SQLCMD scripting mode is enabled check that actual SQL scripts listed in folder are coinsistent to current list                ***/
/***                                                                                                                                                         ***/
/***                                                                                                                                                         ***/
/***                                                                                                                                                         ***/
/***     This code (once SQLCMD scripting mode is enabled) lists scripts in folder (to check if they are coinsistent to the list of scripts)                 ***/
--		 !!dir /B /O "S:\Forum\Database\MANAGEMENT\SQL_code\VR_for_RestrictionsData"
/***                                                                                                                                                         ***/
/***                                                                                                                                                         ***/
/***************************************************************************************************************************************************************/
USE  [GRSHRcode]
GO
/***************************************************************************************************************************************************************/
/* quick check to determine whether SQLCMD mode is on (and terminate the script if not):                                                                       */
/*-------------------------------------------------------------------------------------------------------------------------------------------------------------*/
         :setvar DatabaseName "MyDatabase"
         GO
         IF ('$(DatabaseName)' = '$' + '(DatabaseName)')
            RAISERROR ('This script must be run in SQLCMD mode.', 20, 1) WITH LOG
         GO
/*-------------------------------------------------------------------------------------------------------------------------------------------------------------*/
Print '==> '
Print '==> '
Print '--- '+CONVERT(VARCHAR(19),SYSDATETIME())+' ==>  SQLCMD mode is  <ON>  ---  start running all code  ----------------------------------------------------- '
Print                    '------------------------------------------------------------------------------------------------------------------------------------- '
/***************************************************************************************************************************************************************/
/***************************************************************************************************************************************************************/
/***                                                                                                                                                         ***/
/***                                                                                                                                                         ***/
/***     RE-CREATE ALL TABLES & VIEWS                                                                                                                        ***/
/***                                                                                                                                                         ***/
/***                                                                                                                                                         ***/
/***************************************************************************************************************************************************************/
/*-------------------------------------------------------------------------------------------------------------------------------------------------------------*/
/*    --> store working directory (path) in a variable & execute scripts:                                                                                      */
		:setvar path "S:\Forum\Database\MANAGEMENT\SQL_code\VR_for_RestrictionsData"
/*--------- before coding period ------------------------------------------------------------------------------------------------------------------------------*/
		:r  $(path)\_1_001_cp__cleanDBcode____R.sql
		:r  $(path)\_1_002_cp__ToolsDBcode____R.sql
		:r  $(path)\_1_003_cp__WideGRSHR2y____R.sql
		:r  $(path)\_1_004_cp__3CodersTabs____R.sql
/*--------- codebook extracted from database ------------------------------------------------------------------------------------------------------------------*/
		:r  $(path)\_1_005_CB__ExtCodeBook____R.sql
/*--------- views to process coded data in Access -------------------------------------------------------------------------------------------------------------*/
		:r  $(path)\_2_001_cV_Entered_Vals____R.sql
		:r  $(path)\_2_002_cV_AllCodedVals____R.sql
		:r  $(path)\_2_003_cV_Wide_Changes____R.sql
		:r  $(path)\_2_004_cV_Descriptions____R.sql
		:r  $(path)\_2_005_cV_ReportDataVa____R.sql
/*-------------------------------------------------------------------------------------------------------------------------------------------------------------*/
/***************************************************************************************************************************************************************/
/***************************************************************************************************************************************************************/
Print                    '------------------------------------------------------------------------------------------------------------------------------------- '
Print '--- '+CONVERT(VARCHAR(19),SYSDATETIME())+' ==>  coding tables and views have been RE-CREATED !!!  ------------------------------------------------------ '
Print                    '------------------------------------------------------------------------------------------------------------------------------------- '
/***************************************************************************************************************************************************************/
