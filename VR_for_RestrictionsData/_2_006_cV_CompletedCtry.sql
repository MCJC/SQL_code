/***************************************************************************************************************************************************************/
Print '--- '+CONVERT(VARCHAR(19),SYSDATETIME())+' ==>  script 2.006    ---------------------------------------------------------------------------------------- '
/***************************************************************************************************************************************************************/
/***                                                                                                                                                         ***/
/***                                                                                                                                                         ***/
/***     >>>>>   This is the script used to create the view [GRSHRcode].[dbo].[v06_EnteredValues&Extras]                                           <<<<<     ***/
/***             The table adds calculated variables using the basic coded variables.                                                                        ***/
/***                                                                                                                                                         ***/
/***                                                                                                                                                         ***/
/***************************************************************************************************************************************************************/
USE              [GRSHRcode]
GO
/***************************************************************************************************************************************************************/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/***************************************************************************************************************************************************************/
ALTER  VIEW                      [dbo].[v06_CompletedCtry]        AS
SELECT * FROM
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
(
SELECT 
        [Nation_fk]
      , [Ctry_EditorialName]
      , [Completed]
  FROM
(
SELECT 
        [Nation_fk]
      , [Ctry_EditorialName]
      , [Completed]           = CASE WHEN
										   (/* this list is to be coded later in better way */
	     										[GRI_01]   
											+   [GRI_02]   
											+   [GRI_03]   
											+   [GRI_04]   
											+   [GRI_05]   
											+   [GRI_06]   
											+   [GRI_07]   
											+   [GRI_08]   
											+   [GRI_09]   
											+   [GRI_10]   
											+   [GRI_11]   
											+   [GRI_12]   
											+   [GRI_13]   
											+   [GRI_14]   
											+   [GRI_15]   
											+   [GRI_16]   
											+   [GRI_17]   
											+   [GRI_18]   
											+   [GRI_19]   
											+   [GRI_20_01]   
											+   [GRI_20_02]   
											+   [GRI_20_03_a]   
											+   [GRI_20_03_b]   
											+   [GRI_20_03_c]   
											+   [GRI_20_04]   
											+   [GRI_20_05]   
											+   [GRX_22_01]   
											+   [GRX_22_02]   
											+   [GRX_22_03]   
											+   [GRX_22_04]      
											+   [GRX_30]   
											+   [GRX_31]   
											+   [GRX_32]   
											+   [GRX_36]   
											+   [SHI_01_a]   
											+   [SHI_02]   
											+   [SHI_03]   
											+   [SHI_04]   
											+   [SHI_05]   
											+   [SHI_06]   
											+   [SHI_07]   
											+   [SHI_08]   
											+   [SHI_09]   
											+   [SHI_10]   
											+   [SHI_11_a]   
											+   [SHI_11_b]   
											+   [SHI_12]   
											+   [SHI_13]   
											+   [XSG_S_01]   
											+   [XSG_S_02]   
											+   [XSG_S_03]   
											+   [XSG_S_04]   
											+   [XSG_S_05]   
											+   [XSG_S_06]   
											+   [XSG_S_07]   
											+   [XSG_S_08]   
											+   [XSG_S_09]   
											+   [XSG_S_10]   
											+   [XSG_S_11]   
											+   [XSG_S_12]   
											+   [XSG_S_13]   
											+   [XSG_S_14]   
											+   [XSG_S_15]   
											+   [XSG_S_16]   
											+   [XSG_S_17]   
											+   [XSG_S_18]   
											+   [XSG_S_19]   
											+   [XSG_S_20]   
											+   [XSG_S_21]   
											+   [XSG_S_22]   
											+   [XSG_S_23]      ) IS NOT NULL
                                     THEN 'Y'
                                     ELSE 'N' END
  FROM [v02_AllCodedValues]
 WHERE
       [Question_Year] = 2015
) Ctries
WHERE
        [Completed]                     = 'Y'
) filtered


/***************************************************************************************************************************************************************/
GO
/***************************************************************************************************************************************************************/
