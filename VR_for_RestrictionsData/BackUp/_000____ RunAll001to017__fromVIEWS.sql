/***************************************************************************************************************************************************************/
Print 
'==> ' + CONVERT (VARCHAR(19), SYSDATETIME()) + ' start running all scripts                                                                                 --- '
/***************************************************************************************************************************************************************/
/***                                                                                                                                                         ***/
/***     >>>>>   This is the master script to run all scripts for re-creating views and tables related to GRSHR                                    <<<<<     ***/
/***                                                                                                                                                         ***/
/***        NOTICE:                                                                                                                                          ***/
/***                All tables are created from their corresponding BASE-VIEW                                                                                ***/
/***                Views are updated unless there is a change in structure (adding/removing field, etc.)                                                    ***/
/***                                                                                                                                                         ***/
/***************************************************************************************************************************************************************/


/***************************************************************************************************************************************************************/
IF OBJECT_ID  (N'[forum_ResAnal].[dbo].[vr___00a____NationLocalityTOOL]', N'U') IS NOT NULL
DROP TABLE       [forum_ResAnal].[dbo].[vr___00a____NationLocalityTOOL]
SELECT * 	INTO [forum_ResAnal].[dbo].[vr___00a____NationLocalityTOOL]
            FROM                 [dbo].[vr___00a]
/***************************************************************************************************************************************************************/
GO
/***************************************************************************************************************************************************************/
IF OBJECT_ID  (N'[forum_ResAnal].[dbo].[vr___00b____QuestnReligionTOOL]', N'U') IS NOT NULL
DROP TABLE       [forum_ResAnal].[dbo].[vr___00b____QuestnReligionTOOL]
SELECT * 	INTO [forum_ResAnal].[dbo].[vr___00b____QuestnReligionTOOL]
            FROM                 [dbo].[vr___00b]
/***************************************************************************************************************************************************************/
GO
/***************************************************************************************************************************************************************/
/*------------------------------------------------------------------------------------------------------------------------------------------------*/
/*-----   BackUp current Table     ---------------------------------------------------------------------------------------------------------------*/
/*------------------------------------------------------------------------------------------------------------------------------------------------*/
  DECLARE @CrDt    varchar( 8)
  SET     @CrDt = (CONVERT(VARCHAR(8),GETDATE(),112))
/*------------------------------------------------------------------------------------------------------------------------------------------------*/
EXEC ( '  INSERT INTO   [forum_ResAnal].[dbo].[vr___00x____Long__NoAgg___BkUp]
               SELECT   [BkUp_date]  = ''' + @CrDt + '''
                      , * 	
                 FROM   [forum_ResAnal].[dbo].[vr___01_cDB_Long__NoAggregated]  ' )
/*------------------------------------------------------------------------------------------------------------------------------------------------*/
/*--    TRUNCATE TABLE  [forum_ResAnal].[dbo].[vr___00x____Long__NoAgg___BkUp]    ----------------------------------------------------------------*/
/*------------------------------------------------------------------------------------------------------------------------------------------------*/
IF OBJECT_ID  (N'[forum_ResAnal].[dbo].[vr___01_cDB_Long__NoAggregated]', N'U') IS NOT NULL
DROP TABLE       [forum_ResAnal].[dbo].[vr___01_cDB_Long__NoAggregated]
SELECT * 	INTO [forum_ResAnal].[dbo].[vr___01_cDB_Long__NoAggregated]
            FROM                 [dbo].[vr___01_]
/***************************************************************************************************************************************************************/
GO
/***************************************************************************************************************************************************************/
IF OBJECT_ID  (N'[forum_ResAnal].[dbo].[vr___02_cDB_Wide__by_Ctry&Year]', N'U') IS NOT NULL
DROP TABLE       [forum_ResAnal].[dbo].[vr___02_cDB_Wide__by_Ctry&Year]
SELECT * INTO    [forum_ResAnal].[dbo].[vr___02_cDB_Wide__by_Ctry&Year]
            FROM                 [dbo].[vr___02_]
/***************************************************************************************************************************************************************/
GO
/***************************************************************************************************************************************************************/
IF OBJECT_ID  (N'[forum_ResAnal].[dbo].[vr___03_cDB_W&Xtra_byCtry&Year]', N'U') IS NOT NULL
DROP TABLE       [forum_ResAnal].[dbo].[vr___03_cDB_W&Xtra_byCtry&Year]
SELECT * INTO    [forum_ResAnal].[dbo].[vr___03_cDB_W&Xtra_byCtry&Year]
            FROM                 [dbo].[vr___03_]
/***************************************************************************************************************************************************************/
GO
/***************************************************************************************************************************************************************/
IF OBJECT_ID  (N'[forum_ResAnal].[dbo].[vr___04_cDB_SemiWide_byCtry&Yr]', N'U') IS NOT NULL
DROP TABLE       [forum_ResAnal].[dbo].[vr___04_cDB_SemiWide_byCtry&Yr]
SELECT *    INTO [forum_ResAnal].[dbo].[vr___04_cDB_SemiWide_byCtry&Yr]
            FROM                 [dbo].[vr___04_]
/***************************************************************************************************************************************************************/
GO
/***************************************************************************************************************************************************************/
IF OBJECT_ID  (N'[forum_ResAnal].[dbo].[vr___04v_labSemiWide_byCtry&Yr]', N'U') IS NOT NULL
DROP TABLE       [forum_ResAnal].[dbo].[vr___04v_labSemiWide_byCtry&Yr]
SELECT * INTO    [forum_ResAnal].[dbo].[vr___04v_labSemiWide_byCtry&Yr]
            FROM                 [dbo].[vr___04v]
/***************************************************************************************************************************************************************/
GO
/***************************************************************************************************************************************************************/
IF OBJECT_ID  (N'[forum_ResAnal].[dbo].[vrp__01_cDB_SelDataBYCtry&Year]', N'U') IS NOT NULL
DROP TABLE       [forum_ResAnal].[dbo].[vrp__01_cDB_SelDataBYCtry&Year]
SELECT * INTO    [forum_ResAnal].[dbo].[vrp__01_cDB_SelDataBYCtry&Year]
            FROM                 [dbo].[vrp__01_]
/***************************************************************************************************************************************************************/
GO
/***************************************************************************************************************************************************************/
IF OBJECT_ID  (N'[forum_ResAnal].[dbo].[vrp__01v_labSelDataBYCtry&Year]', N'U') IS NOT NULL
DROP TABLE       [forum_ResAnal].[dbo].[vrp__01v_labSelDataBYCtry&Year]
SELECT * INTO    [forum_ResAnal].[dbo].[vrp__01v_labSelDataBYCtry&Year]
            FROM                 [dbo].[vrp__01v]
/***************************************************************************************************************************************************************/
GO
/***************************************************************************************************************************************************************/
IF OBJECT_ID  (N'[forum_ResAnal].[dbo].[vr___05_cDB_Index_byCtryReg&Yr]', N'U') IS NOT NULL
DROP TABLE       [forum_ResAnal].[dbo].[vr___05_cDB_Index_byCtryReg&Yr]
SELECT * INTO    [forum_ResAnal].[dbo].[vr___05_cDB_Index_byCtryReg&Yr]
            FROM                 [dbo].[vr___05_]
/***************************************************************************************************************************************************************/
GO
/***************************************************************************************************************************************************************/
IF OBJECT_ID  (N'[forum_ResAnal].[dbo].[vr___06_cDB_LongData_ALL_byCYQ]', N'U') IS NOT NULL
DROP TABLE       [forum_ResAnal].[dbo].[vr___06_cDB_LongData_ALL_byCYQ]
SELECT * INTO    [forum_ResAnal].[dbo].[vr___06_cDB_LongData_ALL_byCYQ]
            FROM                 [dbo].[vr___06_]
/***************************************************************************************************************************************************************/
GO
/***************************************************************************************************************************************************************/
IF OBJECT_ID  (N'[forum_ResAnal].[dbo].[vr___07_cDB_MainLongData_byCYQ]', N'U') IS NOT NULL
DROP TABLE       [forum_ResAnal].[dbo].[vr___07_cDB_MainLongData_byCYQ]
SELECT * 	INTO [forum_ResAnal].[dbo].[vr___07_cDB_MainLongData_byCYQ]
            FROM                 [dbo].[vr___07_]
/***************************************************************************************************************************************************************/
GO
/***************************************************************************************************************************************************************/
IF OBJECT_ID  (N'[forum_ResAnal].[dbo].[vr___08_cDB_Weights_f_TopLines]', N'U') IS NOT NULL
DROP TABLE       [forum_ResAnal].[dbo].[vr___08_cDB_Weights_f_TopLines]
SELECT * 	INTO [forum_ResAnal].[dbo].[vr___08_cDB_Weights_f_TopLines]
            FROM                 [dbo].[vr___08_]
/***************************************************************************************************************************************************************/
GO
/***************************************************************************************************************************************************************/
IF OBJECT_ID  (N'[forum_ResAnal].[dbo].[vr___09_cDB_Basic_TopLines_All]', N'U') IS NOT NULL
DROP TABLE       [forum_ResAnal].[dbo].[vr___09_cDB_Basic_TopLines_All]
SELECT * INTO    [forum_ResAnal].[dbo].[vr___09_cDB_Basic_TopLines_All]
            FROM                 [dbo].[vr___09_]
/***************************************************************************************************************************************************************/
GO
/***************************************************************************************************************************************************************/
IF OBJECT_ID  (N'[forum_ResAnal].[dbo].[vr___10_cDB_Published_TopLines]', N'U') IS NOT NULL
DROP TABLE       [forum_ResAnal].[dbo].[vr___10_cDB_Published_TopLines]
SELECT * INTO    [forum_ResAnal].[dbo].[vr___10_cDB_Published_TopLines]
            FROM                 [dbo].[vr___10_]
/***************************************************************************************************************************************************************/
GO
/***************************************************************************************************************************************************************/
IF OBJECT_ID  (N'[forum_ResAnal].[dbo].[vr___11_cDB_RHIndexScore_byReg]', N'U') IS NOT NULL
DROP TABLE       [forum_ResAnal].[dbo].[vr___11_cDB_RHIndexScore_byReg]
SELECT * INTO    [forum_ResAnal].[dbo].[vr___11_cDB_RHIndexScore_byReg]
            FROM                 [dbo].[vr___11_]
/***************************************************************************************************************************************************************/
GO
/***************************************************************************************************************************************************************/
IF OBJECT_ID  (N'[forum_ResAnal].[dbo].[vr___12_cDB_Results_by_Country]', N'U') IS NOT NULL
DROP TABLE       [forum_ResAnal].[dbo].[vr___12_cDB_Results_by_Country]
SELECT * 	INTO [forum_ResAnal].[dbo].[vr___12_cDB_Results_by_Country]
            FROM                 [dbo].[vr___12_]
/***************************************************************************************************************************************************************/
GO
/***************************************************************************************************************************************************************/
