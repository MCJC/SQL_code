USE [RLS]
GO
/*********************************************************************************************************/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*********************************************************************************************************/
ALTER VIEW    [dbo].[Pew_Answer]
AS
/*********************************************************************************************************/
SELECT
/*-------------------------------------------------------------------------------------------------------*/
       [A_pk]                       = ROW_NUMBER()
                                            OVER(
                                        ORDER BY  
                                                [AnswerSet_number]
                                              , [Answer_Std_fk]
                                              , [Answer_fk]        )
/*-------------------------------------------------------------------------------------------------------*/
      ,[Answer_pk]                  = [Answer_fk]
      ,[Answer_Std_fk]
      ,[AnswerSet_num]
      ,[Answer_value]
      ,[Answer_value_Std]
      ,[Answer_value_NoStd]
      ,[Answer_Wording_std]
      ,[Answer_Wording]
      ,[Full_set_of_Answers]
      ,[NA_by_set_of_Answers]
      ,[Question_fk]
/*-------------------------------------------------------------------------------------------------------*/
  FROM [Pew_Q&A]
/*-------------------------------------------------------------------------------------------------------*/
 WHERE
       [Answer_Std_fk]   IS NOT NULL
    OR
       [Answer_fk]       IS NOT NULL
/*-------------------------------------------------------------------------------------------------------*/
-- the filtered rows are ..........................................    26,746   -n chgd after RLSIb loaded
--     26,366 both not null; 380 [Answer_fk] is null
--     -> enough: [Answer_Std_fk] is not null
-- excludes when both [Answer_Std_fk] & [Answer_fk] are null ......       388
--                                FROM a total rows in Q&A of .....    27.134
/*-------------------------------------------------------------------------------------------------------*/
/*********************************************************************************************************/
GO
/*********************************************************************************************************/
