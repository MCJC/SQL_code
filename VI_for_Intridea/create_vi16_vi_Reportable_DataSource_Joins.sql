/* ++> create_vi16_vi_Reportable_DataSource_Joins.sql <++ */
/***************************************************************************************************************************************************************/
/***************************************************************************************************************************************************************/
/***************************************************************************************************************************************************************/
/***************************************************************************************************************************************************************/
/***                                                                                                                                                         ***/
/***     >>>>>   This is the script used to create the view [forum]..[vi_Reportable_DataSource_Joins]                                              <<<<<     ***/
/***                                                                                                                                                         ***/
/***************************************************************************************************************************************************************/
USE [forum]
GO
/***************************************************************************************************************************************************************/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/***************************************************************************************************************************************************************/
ALTER  VIEW
               [dbo].[vi_Reportable_DataSource_Joins]
AS
/***************************************************************************************************************************************************************/
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
          [RDSJv_row]
          =  ROW_NUMBER()
             OVER(ORDER BY
                            List_pk
                          , item_fk
                          , Report_SortingNumber      )
       , List          =    L.List
       , RelatedItem   =    CASE
                            WHEN List_pk = 1 THEN 'Country'
                            WHEN List_pk = 2 THEN 'Locality'
                            WHEN List_pk = 3 THEN 'Religion'
                            WHEN List_pk = 4 THEN 'Topic'
                            WHEN List_pk = 5 THEN 'Question'
                            END
       , List_pk       =    L.List_pk
       , Nation_fk     =    CASE WHEN List_pk = 1 THEN item_fk
                                 ELSE NULL
                            END
       --, Locality_fk   =    CASE WHEN List_pk = 2 THEN item_fk
       --                          ELSE NULL
       --                     END
       , Religion_fk   =    CASE WHEN List_pk = 3 THEN item_fk
                                 ELSE NULL
                            END
       , Topic_fk      =    CASE WHEN List_pk = 4 THEN item_fk
                                 ELSE NULL
                            END
       --, Question_fk   =    CASE WHEN List_pk = 5 THEN item_fk
       --                          ELSE NULL
       --                     END
       , Report_SortingNumber
       , Data_source_fk
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
FROM [forum].[dbo].[Pew_Display_Reports] R
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
JOIN [forum].[dbo].[Pew_Lists]           L
  ON   List_pk
     = List_fk
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
/***************************************************************************************************************************************************************/
go