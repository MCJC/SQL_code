-- previously dropped
/**************************************************************************************************************************/
/*****                                                                                                                *****/
/*****                                    basic cleaning for  [Pew_Answer_NoStd]                                      *****/
/*****                                                                                                                *****/
/**************************************************************************************************************************/
/**************************************************************************************************************************/
/* >   .  remove inconsistent empty answers both unlinked or linked to RLS questions **************************************/
/*        answers not linked by any entity in th database *****************************************************************/
/*------------------------------------------------------------------------------------------------------------------------*/
--	DELETE                                     PANS                            /* deletion statement!                     */
/*------------------------------------------------------------------------------------------------------------------------*/
--	SELECT *                                                                   /* start TEST from this statement...       */
/*------------------------------------------------------------------------------------------------------------------------*/
--  FROM                                                                         /*                                         */
--       [forum].[dbo].[Pew_Answer_NoStd]        PANS                            /* TEST old number of rows...              */  --> 30,610
--/*------------------------------------------------------------------------------------------------------------------------*/
--LEFT                                                                           /*                                         */
--JOIN                                                                           /*                                         */
--       [forum].[dbo].[Pew_Question_NoStd]                                      /*                                         */
--   ON                                                                          /*                                         */
--       [Question_pk]                                                           /*                                         */
--      =[Question_fk]                                                           /* TEST number of rows...                  */  --> 30,610
--/*------------------------------------------------------------------------------------------------------------------------*/
-- WHERE                                                                         /*                                         */
--       [Answer_value_NoStd]    is null                                         /*                                         */
--    AND                                                                        /*                                         */
--       [Answer_Wording]        is null                                         /*                                         */
--    AND                                                                        /*                                         */
--           [Answer_Std_fk]         = -1                                        /* TOTAL null answers                      */  -->    131
--/*------------------------------------------------------------------------------------------------------------------------*/
--    AND                                                                        /*                                         */
--   (   [Question_abbreviation] LIKE  'RLS%'                                    /*                                         */
--    OR                                                                         /*                                         */
--       [Question_abbreviation] is null       )                                 /* === TOTAL null answers                  */  -->    131
/*------------------------------------------------------------------------------------------------------------------------*/
/* <   .  remove inconsistent empty answers both unlinked or linked to RLS questions **************************************/
/**************************************************************************************************************************/
/**************************************************************************************************************************/
/* >   .  remove answers linked to NoStdQs which are unlinked to any StdQs ************************************************/
/*------------------------------------------------------------------------------------------------------------------------*/
--	DELETE                                     PANS                            /* deletion statement!                     */
/*------------------------------------------------------------------------------------------------------------------------*/
--	SELECT *                                                                   /* start TEST from this statement...       */
/*------------------------------------------------------------------------------------------------------------------------*/
--  FROM                                                                         /*                                         */
--/*------------------------------------------------------------------------------------------------------------------------*/
--       [forum].[dbo].[Pew_Answer_NoStd]        PANS                            /* TEST old number of rows...              */
--/*------------------------------------------------------------------------------------------------------------------------*/
--INNER                                                                          /*                                         */
--JOIN                                                                           /*                                         */
--(                                                                              /* >    NoStdQs unlinked to StdQs          */
--  SELECT *                                                                     /*                                         */
--/*------------------------------------------------------------------------------------------------------------------------*/
--  FROM                                                                         /*                                         */
--       [forum].[dbo].[Pew_Question_NoStd]                                      /*                                         */
--/*------------------------------------------------------------------------------------------------------------------------*/
--LEFT                                                                           /*                                         */
-- JOIN                                                                          /*                                         */
--/*------------------------------------------------------------------------------------------------------------------------*/
--       [forum].[dbo].[Pew_Question_Std]                                        /*                                         */
--/*------------------------------------------------------------------------------------------------------------------------*/
--   ON                                                                          /*                                         */
--       [Question_Std_pk]                                                       /*                                         */
--      =[Question_Std_fk]                                                       /*                                         */
--/*------------------------------------------------------------------------------------------------------------------------*/
--WHERE                                                                          /*                                         */
--       [Question_Std_pk]        IS NULL                                        /*                                         */
--/*------------------------------------------------------------------------------------------------------------------------*/
--                                                                   ) NSQultSQ  /* <    NoStdQs unlinked to StdQs          */
--/*------------------------------------------------------------------------------------------------------------------------*/
--   ON                                                                          /*                                         */
--       [Question_pk]                                                           /*                                         */
--      =[Question_fk]                                                           /* TEST number of rows...                  */
/*------------------------------------------------------------------------------------------------------------------------*/  --> 56
/* <   .  remove answers linked to NoStdQs which are unlinked to any StdQs ************************************************/
/**************************************************************************************************************************/




/**************************************************************************************************************************/
/*****                                              BackUp current Table                                              *****/
/**************************************************************************************************************************/
  DECLARE @CrDt    varchar( 8)
  DECLARE                          --  declare variable
          @TofI                    --  variable name
                   varchar(50)     --  data type of the variable
  SET     @CrDt = (CONVERT(VARCHAR(8),GETDATE(),112))
/*------------------------------------------------------------------------------------------------------------------------*/
EXEC ( ' SELECT *
                INTO  [_bk_forum].[dbo].[Pew_Answer_NoStd_' + @CrDt + ']
                FROM      [forum].[dbo].[Pew_Answer_NoStd]' )
/*------------------------------------------------------------------------------------------------------------------------*/
/**************************************************************************************************************************/
--  linked to valid questions but containing replicated answers
/**************************************************************************************************************************/
/*****                                                                                                                *****/
/*****                             basic cleaning of  old NoStd ASnswers from GSI & AFR                               *****/
/*****                                                                                                                *****/
/**************************************************************************************************************************/
/* >>  .  test and remove old NoStdAs from GSI & AFR **********************************************************************/
/*------------------------------------------------------------------------------------------------------------------------*/
--	DELETE                                     PANS                            /* deletion statement!                     */
/*------------------------------------------------------------------------------------------------------------------------*/
--	SELECT *                                                                   /* start TEST from this statement...       */
/*------------------------------------------------------------------------------------------------------------------------*/
--  FROM                                                                         /*                                         */
--       [forum].[dbo].[Pew_Answer_NoStd]        PANS                            /*                                         */
--/*------------------------------------------------------------------------------------------------------------------------*/
--INNER JOIN                                                                     /*                                         */
--/*------------------------------------------------------------------------------------------------------------------------*/
--       [forum].[dbo].[Pew_Question_NoStd]                                      /*                                         */
--/*------------------------------------------------------------------------------------------------------------------------*/
--   ON                                                                          /*                                         */
--       [Question_pk]                                                           /*                                         */
--      =[Question_fk]                                                           /*                                         */
--/*------------------------------------------------------------------------------------------------------------------------*/
--WHERE                                                                          /*                                         */
--       [Answer_Std_fk] LIKE ( -1 )                                             /* TEST number of rows NOT linked to AStd  */  -->    267
--  AND  (                                                                       /*                                         */
--               Question_abbreviation like 'AFR%'                               /*                                         */
--               or                                                              /*                                         */
--               Question_abbreviation like 'GSI%'                               /*                                         */
--       )                                                                       /*                                         */
/*------------------------------------------------------------------------------------------------------------------------*/  -->    153
/* <<  .  test and remove old NoStdAs from GSI & AFR **********************************************************************/
