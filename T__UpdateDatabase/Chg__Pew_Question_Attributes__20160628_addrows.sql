/**************************************************************************************************************************/
USE [forum]
GO
/**************************************************************************************************************************/
/*****                                                    STEP 000                                                    *****/
/*****                                           BackUp  current Table(s)                                             *****/
/**************************************************************************************************************************/
  DECLARE @CrDt    varchar( 8)
  SET     @CrDt = (CONVERT(VARCHAR(8),GETDATE(),112))
/*------------------------------------------------------------------------------------------------------------------------*/
EXEC ( ' SELECT * INTO  [_bk_forum].[dbo].[Pew_Question_Attributes' + '_' + @CrDt + 'c]
                  FROM      [forum].[dbo].[Pew_Question_Attributes]'                      )
/**************************************************************************************************************************/

/**************************************************************************************************************************/
/*****                                                    STEP 001                                                    *****/
/**************************************************************************************************************************/
/*------------------------------------------------------------------------------------------------------------------------*/
	INSERT INTO                                                                /* insert statement                        */
	                                      [Pew_Question_Attributes]            /* target table in current database        */
/*------------------------------------------------------------------------------------------------------------------------*/
SELECT                                                                         /* select statement...                     */
/*------------------------------------------------------------------------------------------------------------------------*/
             [Question_Attributes_pk]  = ROW_NUMBER()                          /* - number all rows                       */
                                         OVER(ORDER BY  [k]  )                 /*   by QApk                               */
                                      + (SELECT MAX([Question_Attributes_pk])  /* - add currently max pk                  */
                                           FROM [Pew_Question_Attributes])     /*   from QAttributes                      */
/*------------------------------------------------------------------------------------------------------------------------*/
           , [Question_Std_fk]         = [k]                                   /* -                                       */
           , [attk]                    = 'PubDS_sort'                          /* -                                       */
           , [attr]                    = [t]                                   /* -                                       */
/*------------------------------------------------------------------------------------------------------------------------*/
      FROM
           (
/*------------------------------------------------------------------------------------------------------------------------*/
/*	GRI_rd_1d =  GRI	*/

select
 [k] = 	908
,[t] = '01'
/*	SHI_rd_1d =  SHI	*/
union
select
 [k] = 	909	
,[t] = '02'
/*------------------------------------------------------------------------------------------------------------------------*/
           ) DDTT
/*------------------------------------------------------------------------------------------------------------------------*/
/**************************************************************************************************************************/

/**************************************************************************************************************************/
/*****                                                    STEP 002                                                    *****/
/**************************************************************************************************************************/
-- check results                                                                                                          --
	select * from                         [Pew_Question_Attributes]            /* test statement...                       */
WHERE                                                                          /* filters...                              */
             [Question_Std_fk]  IN  ( 908, 909 )                               /*            filter condition             */
/**************************************************************************************************************************/


----DELETE     FROM
------select * from
----            [Pew_Question_Attributes]
----WHERE
----            [Question_Attributes_pk]   IN  ( 1369, 1370 )
